import pandas as pd

#sort traces in ascending order by z score as defined by user
#sort traces into activated, no change, or inhibited categories with threshold value defined by user

class sorting_zscore():
    def __init__(self, df_name, stim_start, stim_end, inhib_thresh, act_thresh):
        self.df_name=df_name
        self.stim_start=stim_start
        self.stim_end=stim_end
        self.inhib_thresh=inhib_thresh
        self.act_thresh=act_thresh
        
    def sort_df_by_dff(self):
        x=self.df_name.loc[self.stim_start:self.stim_end]
        y=x.mean(axis=0)
        dff=pd.DataFrame(y)
        dff.columns=['dff']
        self.dff=dff.sort_values(by=['dff'])
        y=self.df_name.T.reindex(self.dff.index)
        return y, self.dff
    
    def sort_dff_by_cat(self):
        self.dff_inhib=self.df_name.T.loc[self.dff['dff'] <=self.inhib_thresh]
        self.dff_nada=self.df_name.T.loc[(self.dff['dff'] >= self.inhib_thresh) & (self.dff['dff']<=self.act_thresh)]
        self.dff_act=self.df_name.T.loc[self.dff['dff']>=self.act_thresh]
        return self.dff_inhib, self.dff_nada, self.dff_act
    
    def sort_df_by_cat(self):
        inhib=self.df_name.T.loc[self.dff_inhib.index]
        nada=self.df_name.T.loc[self.dff_nada.index]
        act=self.df_name.T.loc[self.dff_act.index]
        return inhib.T, nada.T, act.T
